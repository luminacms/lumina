"use strict";layui.define(["jquery","util"],function(a){function t(){this.config={}}var c=layui.$,r=(layui.hint(),layui.device()),e=layui.util,d="element",u="layui-this",f="layui-show";t.prototype.set=function(a){return c.extend(!0,this.config,a),this},t.prototype.on=function(a,t){return layui.onevent.call(this,d,a,t)},t.prototype.tabAdd=function(a,t){var i=c(".layui-tab[lay-filter="+a+"]"),e=i.children(".layui-tab-title"),l=e.children(".layui-tab-bar"),n=i.children(".layui-tab-content"),s='<li lay-id="'+(t.id||"")+'"'+(t.context?" lay-context":"")+(t.attr?' lay-attr="'+t.attr+'"':"")+">"+(t.title||"unnaming")+"</li>";return l[0]?l.before(s):e.append(s),n.append('<div class="layui-tab-item">'+(t.content||"")+"</div>"),g.hideTabMore(!0),g.tabAuto(),this},t.prototype.tabDelete=function(a,t){var i=c(".layui-tab[lay-filter="+a+"]").children(".layui-tab-title").find('>li[lay-id="'+t+'"]');return g.tabDelete(null,i),this},t.prototype.tabChange=function(a,t){var i=c(".layui-tab[lay-filter="+a+"]").children(".layui-tab-title").find('>li[lay-id="'+t+'"]');return g.tabClick.call(i[0],null,null,i),this},t.prototype.tab=function(i){i=i||{},n.on("click",i.headerElem,function(a){var t=c(this).index();g.tabClick.call(this,a,t,null,i)})},t.prototype.progress=function(a,t){var i="layui-progress",e=c("."+i+"[lay-filter="+a+"]").find("."+i+"-bar"),l=e.find("."+i+"-text");return e.css("width",t),l.text(t),this};var p=".layui-nav",h="layui-nav-item",l="layui-nav-bar",y="layui-nav-tree",v="layui-nav-child",b="fa fa-angle-right",m="layui-anim layui-anim-upbit",g={tabClick:function(a,t,i,e){e=e||{};var l=i||c(this),n=(t=t||l.parent().children("li").index(l),e.headerElem?l.parent():l.parents(".layui-tab").eq(0)),s=e.bodyElem?c(e.bodyElem):n.children(".layui-tab-content").children(".layui-tab-item"),o=l.find("a"),r=n.attr("lay-filter");"javascript:;"!==o.attr("href")&&"_blank"===o.attr("target")||(l.addClass(u).siblings().removeClass(u),s.eq(t).addClass(f).siblings().removeClass(f)),layui.event.call(this,d,"tab("+r+")",{elem:n,index:t})},tabContext:function(a,t,i){a.preventDefault();var e=i||c(this);if(!(void 0===e.attr("lay-context")||0<e.find(".m-subtab").length)){t=t||e.parent().children("li").index(e);var l=['<div class="fixed m-subtab" style="z-index:99999;left: '+a.pageX+"px;top: "+a.pageY+'px;"><dl class="layui-nav-child layui-anim-fadein layui-anim layui-anim-upbit layui-show">','<dd lumina-event="refreshThisTab" data-idx="'+t+'"  class="border-b"><a href="javascript:;">刷新</a></dd>','<dd lumina-event="closeThisTabs" data-idx="'+t+'"><a href="javascript:;">关闭</a></dd>','<dd lumina-event="closeOtherTabs" data-idx="'+t+'"><a href="javascript:;">关闭其它标签</a></dd>','<dd lumina-event="closeAllTabs" data-idx="'+t+'"><a href="javascript:;">关闭全部标签</a></dd>','<dd lumina-event="openThisTab" data-idx="'+t+'"><a href="javascript:;">新窗口打开</a></dd></dl></div>'].join("");e.append(l),e.on("mouseleave",function(){e.find(".m-subtab").remove()})}},tabDelete:function(a,t){var i=t||c(this).parent(),e=i.index(),l=i.parents(".layui-tab").eq(0),n=l.children(".layui-tab-content").children(".layui-tab-item"),s=l.attr("lay-filter");i.hasClass(u)&&(i.next()[0]?g.tabClick.call(i.next()[0],null,e+1):i.prev()[0]&&g.tabClick.call(i.prev()[0],null,e-1)),i.remove(),n.eq(e).remove(),setTimeout(function(){g.tabAuto()},50),layui.event.call(this,d,"tabDelete("+s+")",{elem:l,index:e})},tabAuto:function(){var l="layui-tab-bar",n="fa-close",s=this;c(".layui-tab").each(function(){var a=c(this),t=a.children(".layui-tab-title"),i=(a.children(".layui-tab-content").children(".layui-tab-item"),'lay-stope="tabmore"'),e=c('<span class="layui-unselect layui-tab-bar" '+i+"><i "+i+' class="fa">&#xe61a;</i></span>');if(s===window&&8!=r.ie&&g.hideTabMore(!0),a.attr("lay-allowClose")&&t.find("li").each(function(){var a=c(this);if(!a.find("."+n)[0]){var t=c('<i class="fa layui-unselect '+n+'"></i>');t.on("click",g.tabDelete),a.append(t)}}),"string"!=typeof a.attr("lay-unauto"))if(t.prop("scrollWidth")>t.outerWidth()+1){if(t.find("."+l)[0])return;t.append(e),a.attr("overflow",""),e.on("click",function(a){t[this.title?"removeClass":"addClass"]("layui-tab-more"),this.title=this.title?"":"收缩"})}else t.find("."+l).remove(),a.removeAttr("overflow")})},hideTabMore:function(a){var t=c(".layui-tab-title");!0!==a&&"tabmore"===c(a.target).attr("lay-stope")||(t.removeClass("layui-tab-more"),t.find(".layui-tab-bar").attr("title",""))},clickThis:function(){var a=c(this),t=a.parents(p),i=t.attr("lay-filter"),e=a.parent(),l=a.siblings("."+v),n="string"==typeof e.attr("lay-unselect");"javascript:;"!==a.attr("href")&&"_blank"===a.attr("target")||n||l[0]||(t.find("."+u).removeClass(u),e.addClass(u)),t.hasClass(y)&&(l.removeClass(m),l[0]&&(e["none"===l.css("display")?"addClass":"removeClass"](h+"ed"),"all"===t.attr("lay-shrink")&&e.siblings().removeClass(h+"ed"))),layui.event.call(this,d,"nav("+i+")",a)},collapse:function(){var a=c(this),t=(a.find(".layui-colla-icon"),a.siblings(".layui-colla-content")),i=a.parents(".layui-collapse").eq(0),e=i.attr("lay-filter"),l="none"===t.css("display");if("string"==typeof i.attr("lay-accordion")){var n=i.children(".layui-colla-item").children("."+f);n.siblings(".layui-colla-title").children(".layui-colla-icon"),n.removeClass(f)}t[l?"addClass":"removeClass"](f),layui.event.call(this,d,"collapse("+e+")",{title:a,content:t,show:l})},previewMedia:function(){c(".J_player").each(function(){var a=c(this),t=a.data("type"),i=a.data("uri");a.unbind(),a.click(function(){e.loadJs("//cdn.jsdelivr.net/npm/xgplayer@1.1.7/browser/index.js",function(){if("mp4"==t||"video"==t)layer.open({type:1,title:!1,area:"800px",closeBtn:1,shade:.8,shadeClose:!0,offset:"60px",content:'<div id="xgvideo" class="overflow-hidden"></div>',success:function(){new Player({id:"xgvideo",fluid:!0,autoplay:!0,ignores:["theme-default","cover","backward","forward","meta","next","prev","template"],url:[{name:"",src:i,poster:""}]})}});else{if("audio"!=t&&"mp3"!=t)return void layer.msg("暂不支持"+t+"格式文件播放");e.loadJs("//cdn.jsdelivr.net/npm/xgplayer-music/browser/index.js",function(){layer.open({type:1,title:!1,area:"600px",closeBtn:1,shade:0,offset:"60px",shadeClose:!0,content:'<div id="xgmusic" class="overflow-hidden"></div>',success:function(){new Music({id:"xgmusic",url:[{src:i,name:"音频预览",vid:"000001",poster:""}],volume:.8,width:"100%",height:50,preloadNext:!0})}})})}})})})}};t.prototype.render=t.prototype.init=function(a,t){var i=t?'[lay-filter="'+t+'"]':"",e={tab:function(){g.tabAuto.call({})},nav:function(){var n={},s={},o={};c(p+i).each(function(a){var t=c(this),i=c('<span class="'+l+'"></span>'),e=t.find("."+h);t.find("."+l)[0]||(t.append(i),e.on("mouseenter",function(){(function(a,t,i){var e=c(this),l=e.find("."+v);t.hasClass(y)?a.css({top:e.position().top,height:e.children("a").outerHeight(),opacity:1}):(l.addClass(m),a.css({left:e.position().left+parseFloat(e.css("marginLeft")),top:e.position().top+e.height()-a.height()}),n[i]=setTimeout(function(){a.css({width:e.width(),opacity:1})},r.ie&&r.ie<10?0:200),clearTimeout(o[i]),"block"===l.css("display")&&clearTimeout(s[i]),s[i]=setTimeout(function(){l.addClass(f),e.find("."+b).addClass(b+"d")},300))}).call(this,i,t,a)}).on("mouseleave",function(){t.hasClass(y)||(clearTimeout(s[a]),s[a]=setTimeout(function(){t.find("."+v).removeClass(f),t.find("."+b).removeClass(b+"d")},300))}),t.on("mouseleave",function(){clearTimeout(n[a]),o[a]=setTimeout(function(){t.hasClass(y)?i.css({height:0,top:i.position().top+i.height()/2,opacity:0}):i.css({width:0,left:i.position().left+i.width()/2,opacity:0})},200)})),e.find("a").each(function(){var a=c(this);a.parent(),a.siblings("."+v);a.off("click",g.clickThis).on("click",g.clickThis)})})},breadcrumb:function(){c(".layui-breadcrumb"+i).each(function(){var a=c(this),t="lay-separator",i=a.attr(t)||"/",e=a.find("a");e.next("span["+t+"]")[0]||(e.each(function(a){a!==e.length-1&&c(this).after("<span "+t+">"+i+"</span>")}),a.css("visibility","visible"))})},progress:function(){var e="layui-progress";c("."+e+i).each(function(){var a=c(this),t=a.find(".layui-progress-bar"),i=t.attr("lay-percent");t.css("width",/^.+\/.+$/.test(i)?100*new Function("return "+i)()+"%":i),a.attr("lay-showPercent")&&setTimeout(function(){t.html('<span class="'+e+'-text">'+i+"</span>")},350)})},collapse:function(){c(".layui-collapse"+i).each(function(){c(this).find(".layui-colla-item").each(function(){var a=c(this),t=a.find(".layui-colla-title");a.find(".layui-colla-content").css("display");t.find(".layui-colla-icon").remove(),t.append('<i class="fa layui-colla-icon"></i>'),t.off("click",g.collapse).on("click",g.collapse)})})},media:function(){g.previewMedia.call({})}};return e[a]?e[a]():layui.each(e,function(a,t){t()})};var i=new t,n=c(document);i.render();var s=".layui-tab-title>li";n.off().on("click",s,g.tabClick),n.on("contextmenu",s,g.tabContext),n.on("click",g.hideTabMore),a(d,i)});