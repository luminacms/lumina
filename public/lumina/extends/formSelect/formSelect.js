"use strict";function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(e,t,n){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=n():"function"==typeof define&&define.amd?define(n):t.layui&&e.define?e.define(["jquery"],function(t){e.link(e.setter.base+"lib/extend/formSelect/formSelect.css"),t("formSelect",n())}):t.formSelect=n()}("undefined"==typeof layui?null:layui,window,function(){function m(t){var e=this;this.config={name:null,max:null,maxTips:function(){var t=B('[xid="'.concat(e.config.name,'"]')).prev().find(".".concat(v));t.parents(".layui-form-item[pane]").length&&(t=t.parents(".layui-form-item[pane]")),t.attr("style","border-color: red !important"),setTimeout(function(){t.removeAttr("style")},300)},init:null,on:null,opened:null,closed:null,filter:function(t,e,n){return-1==n.name.indexOf(e)},clearid:-1,direction:"auto",height:null,isEmpty:!1,btns:[a[0],a[1],a[2]],searchType:0,create:function(){return Date.now()},template:function(t,e){return e.name},showCount:0,isCreate:!1,placeholder:n,clearInput:!1},this.select=null,this.values=[],B.extend(this.config,t,{searchUrl:t.isSearch?t.searchUrl:null,placeholder:t.optionsFirst&&!t.optionsFirst.value&&t.optionsFirst.innerHTML||n,btns:t.radio?[a[1]]:[a[0],a[1],a[2]]},o[t.name]||c),(isNaN(this.config.showCount)||this.config.showCount<=0)&&(this.config.showCount=19921012)}function t(){this.appender(),this.on(),this.onreset()}var v="xm-select",y="xm-select-parent",g="xm-select-input",x="xm-select--suffix",C="xm-select-this",k="xm-select-label",b="xm-select-search",w="xm-select-search-type",S="xm-select-skin",T="xm-dis-disabled",L="xm-select-dis",p="xm-select-temp",j="xm-select-radio",A="xm-select-linkage",E="xm-select-dl",h="xm-select-hide",N="xm-hide-input",D="xm-select-sj",H="xm-select-title",F="xm-form-select",d="xm-form-selected",_="xm-select-none",O="xm-select-empty",I="xm-input",P="xm-dl-input",V="xm-select-tips",U="XM_PID_VALUE",M="xm-cz",i="xm-cz-group",n="请选择",W={},J={on:{},endOn:{},filter:{},maxTips:{},opened:{},closed:{}},R={type:"get",header:{},first:!0,data:{},searchUrl:"",searchName:"keyword",searchVal:null,keyName:"name",keyVal:"value",keySel:"selected",keyDis:"disabled",keyChildren:"children",dataType:"",delay:500,beforeSuccess:null,success:null,error:null,beforeSearch:null,response:{statusCode:0,statusName:"code",msgName:"msg",dataName:"data"},tree:{nextClick:function(t,e,n){n([])},folderChoose:!0,lazy:!0}},a=[{icon:"xm-iconfont icon-quanxuan",name:"全选",click:function(t,e){e.selectAll(t,!0,!0)}},{icon:"xm-iconfont icon-qingkong",name:"清空",click:function(t,e){e.removeAll(t,!0,!0)}},{icon:"xm-iconfont icon-fanxuan",name:"反选",click:function(t,e){e.reverse(t,!0,!0)}},{icon:"xm-iconfont icon-pifu",name:"换肤",click:function(t,e){e.skin(t)}}],B=window.$||window.layui&&window.layui.jquery,l=B(window),q={},c={},o={};t.prototype.appender=function(){Array.prototype.map||(Array.prototype.map=function(t,e){var n,a,c,o,i,r=Object(this),l=r.length>>>0;for(e&&(n=e),a=new Array(l),c=0;c<l;){c in r&&(o=r[c],i=t.call(n,o,c,r),a[c]=i),c++}return a}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){var n,a;if(null==this)throw new TypeError("this is null or not defined");var c,o=Object(this),i=o.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(1<arguments.length&&(n=e),a=0;a<i;){a in o&&(c=o[a],t.call(n,c,a,o)),a++}}),Array.prototype.filter||(Array.prototype.filter=function(t){if(null==this)throw new TypeError;var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var a,c=[],o=arguments[1],i=0;i<n;i++){i in e&&(a=e[i],t.call(o,a,i,e)&&c.push(a))}return c})},t.prototype.init=function(t){var h=this;B(t||"select[".concat(v,"]")).each(function(t,e){var n=B(e),a=n.attr(v),c=n.next(".layui-form-select"),o=n.next(".".concat(y)),i={name:a,disabled:e.disabled,max:+n.attr("xm-select-max"),isSearch:null!=n.attr(b),searchUrl:n.attr(b),isCreate:null!=n.attr("xm-select-create"),radio:null!=n.attr(j),skin:n.attr(S),direction:n.attr("xm-select-direction"),optionsFirst:e.options[0],height:n.attr("xm-select-height"),formname:n.attr("name")||n.attr("_name"),layverify:n.attr("lay-verify")||n.attr("_lay-verify"),layverType:n.attr("lay-verType"),searchType:"dl"==n.attr(w)?1:0,showCount:+n.attr("xm-select-show-count")},r=n.find("option[selected]").toArray().map(function(t){return{name:t.innerHTML,value:t.value}}),l=new m(i);l.values=r,l.config.init?(l.values=l.config.init.map(function(t){return"object"==_typeof(t)?t:{name:n.find('option[value="'.concat(t,'"]')).text(),value:t}}).filter(function(t){return t.name}),l.config.init=l.values.concat([])):l.config.init=r.concat([]),l.values||(l.values=[]),W[a]=l,c[0]&&c.remove(),o[0]&&o.remove();var s=h.renderSelect(a,l.config.placeholder,e),d=l.config.height&&"auto"!=l.config.height?'xm-hg style="height: 34px;"':"",f=['<div class="'.concat(k,'">'),'<input type="text" fsw class="'.concat(I," ").concat(g,'" ').concat(l.config.isSearch?"":'style="display: none;"',' autocomplete="off" debounce="0" />'),"</div>"],u=B('<div class="'.concat(F,'" ').concat(S,'="').concat(l.config.skin,'">\n\t\t\t\t\t<input class="').concat(N,'" value="" name="').concat(l.config.formname,'" lay-verify="').concat(l.config.layverify,'" lay-verType="').concat(l.config.layverType,'" type="text" style="position: absolute;bottom: 0; z-index: -1;width: 100%; height: 100%; border: none; opacity: 0;"/>\n\t\t\t\t\t<div class="').concat(H," ").concat(l.config.disabled?L:"",'">\n\t\t\t\t\t\t<div class="').concat(I," ").concat(v,'" ').concat(d,">\n\t\t\t\t\t\t\t").concat(f.join(""),'\n\t\t\t\t\t\t\t<i class="').concat(D,'"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="').concat(x,'">\n\t\t\t\t\t\t\t<input type="text" autocomplete="off" placeholder="').concat(l.config.placeholder,'" readonly="readonly" unselectable="on" class="').concat(I,'">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<dl xid="').concat(a,'" class="').concat(E," ").concat(l.config.radio?j:"",'">').concat(s,"</dl>\n\t\t\t\t</div>")),p=B('<div class="'.concat(y,'" FS_ID="').concat(a,'"></div>'));p.append(u),n.after(p),n.attr("lay-ignore",""),n.removeAttr("name")&&n.attr("_name",l.config.formname),n.removeAttr("lay-verify")&&n.attr("_lay-verify",l.config.layverify),l.config.isSearch?(q[a]=B.extend({},R,{searchUrl:l.config.searchUrl},q[a]),B(document).on("input","div.".concat(y,'[FS_ID="').concat(a,'"] .').concat(g),function(t){h.search(a,t,l.config.searchUrl)}),l.config.searchUrl&&h.triggerSearch(u,!0)):u.find("dl dd.".concat(P)).css("display","none")})},t.prototype.search=function(c,t,e,n){var a,o=this;if(n)a=n;else{a=t.target;var i=t.keyCode;if(9===i||13===i||37===i||38===i||39===i||40===i)return!1}var r=B.trim(a.value);this.changePlaceHolder(B(a));var l=q[c]?q[c]:R;e=l.searchUrl||e;var s,d=W[c],f=d.config.isCreate,u=B('dl[xid="'.concat(c,'"]')).parents(".".concat(F));e?(l.searchVal&&(r=l.searchVal,l.searchVal=""),(!l.beforeSearch||l.beforeSearch&&l.beforeSearch instanceof Function&&l.beforeSearch(c,e,r))&&(s=l.delay,l.first&&(l.first=!1,s=10),clearTimeout(d.clearid),d.clearid=setTimeout(function(){u.find("dl > *:not(.".concat(V,")")).remove(),u.find("dd.".concat(_)).addClass(O).text("请求中"),o.ajax(c,e,r,!1,null,!0)},s))):(u.find("dl .".concat(h)).removeClass(h),u.find("dl dd:not(.".concat(V,")")).each(function(t,e){var n=B(e),a=J.filter[c]||W[c].config.filter;a&&1==a(c,r,o.getItem(c,n),n.hasClass(T))&&n.addClass(h)}),u.find("dl dt").each(function(t,e){B(e).nextUntil("dt",":not(.".concat(h,")")).length||B(e).addClass(h)}),this.create(c,f,r),u.find("dl dd:not(.".concat(V,"):not(.").concat(h,")")).length?u.find("dd.".concat(_)).removeClass(O):u.find("dd.".concat(_)).addClass(O).text("无匹配项"))},t.prototype.isArray=function(t){return"[object Array]"==Object.prototype.toString.call(t)},t.prototype.triggerSearch=function(t,a){var c=this;(t?[t]:B(".".concat(F)).toArray()).forEach(function(t,e){var n=(t=B(t)).find("dl").attr("xid");(n&&W[n]&&W[n].config.isEmpty||a)&&c.search(n,null,null,0==W[n].config.searchType?t.find(".".concat(k," .").concat(g)):t.find("dl .".concat(P," .").concat(g)))})},t.prototype.clearInput=function(t){var e=B(".".concat(y,'[fs_id="').concat(t,'"]'));(0==W[t].config.searchType?e.find(".".concat(k," .").concat(g)):e.find("dl .".concat(P," .").concat(g))).val("")},t.prototype.ajax=function(n,a,c,o,i,r,l,s){var d,t,f=this,u=B(".".concat(y,' dl[xid="').concat(n,'"]')).parents(".".concat(F));u[0]&&a&&(d=q[n]?q[n]:R,(t=B.extend(!0,{},d.data))[d.searchName]=c,B.ajax({type:d.type,headers:d.header,url:a,data:"json"==d.dataType?JSON.stringify(t):t,success:function(t){var e;"string"==typeof t&&(t=JSON.parse(t)),d.beforeSuccess&&d.beforeSuccess instanceof Function&&(t=d.beforeSuccess(n,a,c,t)),f.isArray(t)&&((e={})[d.response.statusName]=d.response.statusCode,e[d.response.msgName]="",e[d.response.dataName]=t,t=e),t[d.response.statusName]!=d.response.statusCode?u.find("dd.".concat(_)).addClass(O).text(t[d.response.msgName]):(u.find("dd.".concat(_)).removeClass(O),f.renderData(n,t[d.response.dataName],o,i,r,s),W[n].config.isEmpty=0==t[d.response.dataName].length),l&&l(n),d.success&&d.success instanceof Function&&d.success(n,a,c,t)},error:function(t){u.find("dd[lay-value]:not(.".concat(V,")")).remove(),u.find("dd.".concat(_)).addClass(O).text("服务异常"),d.error&&d.error instanceof Function&&d.error(n,a,c,t)}}))},t.prototype.renderData=function(n,t,e,a,c,o){var i,r,l,s,d,f,u,p=this;e?this.renderLinkage(n,t,a):o?this.renderReplace(n,t):(i=B(".".concat(y,' dl[xid="').concat(n,'"]')).parents(".".concat(F)),r=q[n]?q[n]:R,l=i.find(".".concat(x," input")),t=this.exchangeData(n,t),s=[],i.find("dl").html(this.renderSelect(n,l.attr("placeholder")||l.attr("back"),t.map(function(t){var e=B.extend({},t,{innerHTML:t[r.keyName],value:t[r.keyVal],sel:t[r.keySel],disabled:t[r.keyDis],type:t.type,name:t[r.keyName]});return e.sel&&s.push(e),e}))),d=i.find(".".concat(k)),f=i.find("dl[xid]"),c?((u=W[n].values).forEach(function(t,e){f.find('dd[lay-value="'.concat(t.value,'"]')).addClass(C)}),s.forEach(function(t,e){-1==p.indexOf(u,t)&&(p.addLabel(n,d,t),f.find('dd[lay-value="'.concat(t.value,'"]')).addClass(C),u.push(t))})):(s.forEach(function(t,e){p.addLabel(n,d,t),f.find('dd[lay-value="'.concat(t.value,'"]')).addClass(C)}),W[n].values=s),this.commonHandler(n,d))},t.prototype.renderLinkage=function(i,t,n){var e=[],a=0,r={0:t},l=q[i]?q[i]:R;z[i]={};for(;function(){var o=e[a++]=[],t=r;r={},B.each(t,function(c,t){B.each(t,function(t,e){var n={pid:c,name:e[l.keyName],value:e[l.keyVal]};z[i][n.value]=B.extend(e,n),o.push(n);var a=e[l.keyChildren];a&&a.length&&(r[n.value]=a)})})}(),Object.getOwnPropertyNames(r).length;);var c=B(".".concat(y,' dl[xid="').concat(i,'"]')).parents(".".concat(F)),o=['<div class="xm-select-linkage">'];B.each(e,function(t,e){var a=['<div style="left: '.concat(n*t,'px;" class="xm-select-linkage-group xm-select-linkage-group').concat(t+1," ").concat(0!=t?"xm-select-linkage-hide":"",'">')];B.each(e,function(t,e){var n='<li title="'.concat(e.name,'" pid="').concat(e.pid,'" xm-value="').concat(e.value,'"><span>').concat(e.name,"</span></li>");a.push(n)}),a.push("</div>"),o=o.concat(a)}),o.push('<div style="clear: both; height: 288px;"></div>'),o.push("</div>"),c.find("dl").html(o.join("")),c.find(".".concat(g)).css("display","none")},t.prototype.renderReplace=function(n,t){var a=this,e=B(".".concat(y,' dl[xid="').concat(n,'"]')),c=q[n]?q[n]:R;t=this.exchangeData(n,t);var o=(z[n]=t).map(function(t){var e=B.extend({},t,{innerHTML:t[c.keyName],value:t[c.keyVal],sel:t[c.keySel],disabled:t[c.keyDis],type:t.type,name:t[c.keyName]});return a.createDD(n,e)}).join("");e.find("dd:not(.".concat(V,"),dt:not([style])")).remove(),e.find("dt[style]").after(B(o))},t.prototype.exchangeData=function(t,e){var n=q[t]?q[t]:R,a=n.keyChildren,c=n.keyDis;return z[t]={},this.getChildrenList(e,a,c,[],!1)},t.prototype.getChildrenList=function(t,e,n,a,c){for(var o=[],i=0,r=0;r<t.length;r++){var l,s,d,f,u=t[r];u.type&&"optgroup"==u.type?o.push(u):(i++,(l=a.concat([])).push("".concat(i-1,"_E")),u[U]=JSON.stringify(l),u[n]=u[n]||c,o.push(u),(s=u[e])&&X.isArray(s)&&s.length&&(u.XM_TREE_FOLDER=!0,d=l.concat([]),f=this.getChildrenList(s,e,n,d,u[n]),o=o.concat(f)))}return o},t.prototype.create=function(t,e,n){var a,c,o,i,r,l;e&&n?(a=W[t],o=(c=B('[xid="'.concat(t,'"]'))).find("dd.".concat(V,".").concat(P)),i=null,r=c.find("dd.".concat(p)),c.find("dd:not(.".concat(V,"):not(.").concat(p,")")).each(function(t,e){n==B(e).find("span").attr("name")&&(i=e)}),i||(l=a.config.create(t,n),r[0]?(r.attr("lay-value",l),r.find("span").text(n),r.find("span").attr("name",n),r.removeClass(h)):o.after(B(this.createDD(t,{name:n,innerHTML:n,value:l},"".concat(p," ").concat("xm-select-create-long")))))):B("[xid=".concat(t,"] dd.").concat(p)).remove()},t.prototype.createDD=function(t,e,n){var a,c=q[t]?q[t]:R,o=B.trim(e.innerHTML);z[t][e.value]=B(e).is("option")?((a={})[c.keyName]=o,a[c.keyVal]=e.value,a[c.keyDis]=e.disabled,e=a):e;var i=W[t].config.template(t,e),r=e[U],l=-1==(r=r?JSON.parse(r):[-1])[0]?"":'tree-id="'.concat(r.join("-"),'" tree-folder="').concat(!!e.XM_TREE_FOLDER,'"');return'<dd lay-value="'.concat(e.value,'" class="').concat(e.disabled?T:""," ").concat(n||"",'" ').concat(l,'>\n\t\t\t\t\t<div class="xm-unselect xm-form-checkbox ').concat(e.disabled?T:"",'"  style="margin-left: ').concat(30*(r.length-1),'px">\n\t\t\t\t\t\t<i class="').concat("xm-iconfont",'"></i>\n\t\t\t\t\t\t<span name="').concat(o,'">').concat(i,"</span>\n\t\t\t\t\t</div>\n\t\t\t\t</dd>")},t.prototype.createQuickBtn=function(t,e){return'<div class="'.concat(M,'" method="').concat(t.name,'" title="').concat(t.name,'" ').concat(e?'style="margin-right: '+e+'"':"",'><i class="').concat(t.icon,'"></i><span>').concat(t.name,"</span></div>")},t.prototype.renderBtns=function(t,e,n){var a=this,c=[],o=B('dl[xid="'.concat(t,'"]'));return c.push('<div class="'.concat(i,'" show="').concat(e,'" style="max-width: ').concat(o.prev().width()-54,'px;">')),B.each(W[t].config.btns,function(t,e){c.push(a.createQuickBtn(e,n))}),c.push("</div>"),c.push(this.createQuickBtn({icon:"xm-iconfont icon-caidan",name:""})),c.join("")},t.prototype.renderSelect=function(n,t,e){var a=this;z[n]={};var c=[];return W[n].config.btns.length?(setTimeout(function(){var t=B('dl[xid="'.concat(n,'"]'));t.parents(".".concat(F)).attr(w,W[n].config.searchType),t.find(".".concat(i)).css("max-width","".concat(t.prev().width()-54,"px"))},10),c.push(['<dd lay-value="" class="'.concat(V,'" style="background-color: #FFF!important;">'),this.renderBtns(n,null,"30px"),"</dd>",'<dd lay-value="" class="'.concat(V," ").concat(P,'" style="background-color: #FFF!important;">'),'<i class="xm-iconfont icon-sousuo"></i>','<input type="text" class="'.concat(I," ").concat(g,'" placeholder="请搜索"/>'),"</dd>"].join(""))):c.push('<dd lay-value="" class="'.concat(V,'">').concat(t,"</dd>")),this.isArray(e)?B(e).each(function(t,e){e&&(e.type&&"optgroup"===e.type?c.push("<dt>".concat(e.name,"</dt>")):c.push(a.createDD(n,e)))}):B(e).find("*").each(function(t,e){"option"==e.tagName.toLowerCase()&&0==t&&!e.value||("optgroup"===e.tagName.toLowerCase()?c.push("<dt>".concat(e.label,"</dt>")):c.push(a.createDD(n,e)))}),c.push('<dt style="display:none;"> </dt>'),c.push('<dd class="'.concat(V," ").concat(_," ").concat(2===c.length?O:"",'">没有选项</dd>')),c.join("")},t.prototype.on=function(){var n=this;this.one(),B(document).on("click",function(t){B(t.target).parents(".".concat(H))[0]||(B(".".concat(y," dl .").concat(h)).removeClass(h),B(".".concat(y," dl dd.").concat(O)).removeClass(O),B(".".concat(y," dl dd.").concat(p)).remove(),B.each(W,function(t,e){n.clearInput(t),e.values.length||n.changePlaceHolder(B('div[FS_ID="'.concat(t,'"] .').concat(k)))})),B(".".concat(y," .").concat(d)).each(function(t,e){n.changeShow(B(e).find(".".concat(H)),!1)})})},t.prototype.calcLabelLeft=function(t,e,n){var a=this.getPosition(t[0]);a.y=a.x+t[0].clientWidth;var c,o,i,r,l=t[0].offsetLeft;t.find("span").length?n?(c="none"==(c=t.find("span:last")).css("display")?c.prev()[0]:c[0],(o=this.getPosition(c)).y=o.x+c.clientWidth,l=o.y>a.y?l-(o.y-a.y)-5:0):e<0?(i="none"==(i=t.find(":last")).css("display")?i.prev()[0]:i[0],(r=this.getPosition(i)).y=r.x+i.clientWidth,r.y>a.y&&(l-=10)):(l<0&&(l+=10),0<l&&(l=0)):l=0,t.css("left",l+"px")},t.prototype.one=function(t){var b=this;B(t||document).off("click",".".concat(H)).on("click",".".concat(H),function(t){var e=B(t.target),n=e.is(H)?e:e.parents(".".concat(H)),a=n.next(),c=a.attr("xid");if(B("dl[xid]").not(a).each(function(t,e){b.clearInput(B(e).attr("xid"))}),B("dl[xid]").not(a).find("dd.".concat(h)).removeClass(h),n.hasClass(L))return!1;if(e.is(".".concat(D))||e.is(".".concat(g,"[readonly]")))return b.changeShow(n,!n.parents(".".concat(F)).hasClass(d)),!1;if(n.find(".".concat(g,":not(readonly)"))[0]){var o=n.find(".".concat(g)),i={x:t.pageX,y:t.pageY},r=b.getPosition(n[0]);for(n.width();i.x>r.x;){if(B(document.elementFromPoint(i.x,i.y)).is(o))return o.focus(),b.changeShow(n,!0),!1;i.x-=50}}if(e.is(".".concat(g)))return b.changeShow(n,!0),!1;if(e.is('i[fsw="'.concat(v,'"]'))){var l=b.getItem(c,e),s=a.find("dd[lay-value='".concat(l.value,"']"));return s.hasClass(T)?!1:(b.handlerLabel(c,s,!1,l),!1)}return b.changeShow(n,!n.parents(".".concat(F)).hasClass(d)),!1}),B(t||document).off("click","dl.".concat(E)).on("click","dl.".concat(E),function(t){var e=B(t.target);if(e.is(".".concat(A))||e.parents(".".concat(A))[0]){var n=(e=e.is("li")?e:e.parents("li[xm-value]")).parents(".xm-select-linkage-group"),a=e.parents("dl").attr("xid");if(!a)return!1;n.find(".xm-select-active").removeClass("xm-select-active"),e.addClass("xm-select-active"),n.nextAll(".xm-select-linkage-group").addClass("xm-select-linkage-hide");var c=n.next(".xm-select-linkage-group");if(c.find("li").addClass("xm-select-linkage-hide"),c.find('li[pid="'.concat(e.attr("xm-value"),'"]')).removeClass("xm-select-linkage-hide"),c[0]&&0!=c.find("li:not(.xm-select-linkage-hide)").length)c.removeClass("xm-select-linkage-hide");else{var o=[],i=0,r=!e.hasClass("xm-select-this");for(W[a].config.radio&&e.parents(".xm-select-linkage").find(".xm-select-this").removeClass("xm-select-this");o[i++]={name:e.find("span").text(),value:e.attr("xm-value")},(e=e.parents(".xm-select-linkage-group").prev().find('li[xm-value="'.concat(e.attr("pid"),'"]'))).length;);o.reverse();var l={name:o.map(function(t){return t.name}).join("/"),value:o.map(function(t){return t.value}).join("/")};b.handlerLabel(a,null,r,l)}return!1}if(e.is("dl"))return!1;if(e.is("dt"))return e.nextUntil("dt").each(function(t,e){(e=B(e)).hasClass(T)||e.hasClass(C)||e.find("i:not(.icon-expand)").click()}),!1;var s=e.is("dd")?e:e.parents("dd"),d=s.parent("dl").attr("xid");if(s.hasClass(T))return!1;if(e.is("i.icon-caidan")){var f=[],u=[];return e.parents("dl").find('dd[tree-folder="true"]').each(function(t,e){null==B(e).attr("xm-tree-hidn")?f.push(e):u.push(e)}),(u.length?u:f).forEach(function(t){return t.click()}),!1}var p=s.attr("tree-id");if(p){if(e.is("i:not(.icon-expand)"))return b.handlerLabel(d,s,!s.hasClass(C)),!1;var h=q[d]||R,m=h.tree,v=s.nextAll('dd[tree-id^="'.concat(p,'"]'));if(v&&v.length){var y=v[0].clientHeight;return y?(b.addTreeHeight(s,y),y=0):(y=s.attr("xm-tree-hidn")||36,s.removeAttr("xm-tree-hidn"),s.find(">i").remove(),v=v.filter(function(t,e){return B(e).attr("tree-id").split("-").length-1==p.split("-").length})),v.animate({height:y},150),!1}if(m.nextClick&&m.nextClick instanceof Function)return m.nextClick(d,b.getItem(d,s),function(t){var n;t&&t.length?(s.attr("tree-folder","true"),n=[],t.forEach(function(t,e){t.innerHTML=t[h.keyName],t[U]=JSON.stringify(p.split("-").concat([e])),n.push(b.createDD(d,t)),z[d][t[h.keyVal]]=t}),s.after(n.join(""))):b.handlerLabel(d,s,!s.hasClass(C))}),!1}if(s.hasClass(V)){var g=e.is(".".concat(M))?e:e.parents(".".concat(M));if(!g[0])return!1;var x=g.attr("method"),k=W[d].config.btns.filter(function(t){return t.name==x})[0];return k&&k.click&&k.click instanceof Function&&k.click(d,b),!1}return b.handlerLabel(d,s,!s.hasClass(C)),!1})},t.prototype.addTreeHeight=function(t,a){var c=this,e=t.attr("tree-id"),n=t.nextAll('dd[tree-id^="'.concat(e,'"]'));n.length&&(t.append('<i class="xm-iconfont icon-expand"></i>'),t.attr("xm-tree-hidn",a),n.each(function(t,e){var n=B(e);c.addTreeHeight(n,a)}))};var z={};t.prototype.getItem=function(t,e){if(e instanceof B){if(e.is('i[fsw="'.concat(v,'"]'))){var n=e.parent();return z[t][e]||{name:n.find("font").text(),value:n.attr("value")}}var a=e.attr("lay-value");return z[t][a]?z[t][a]:z[t][a]={name:e.find("span[name]").attr("name"),value:a}}return"string"==typeof e&&-1!=e.indexOf("/")?z[t][e]||{name:this.valToName(t,e),value:e}:z[t][e]},t.prototype.linkageAdd=function(t,e){var n=B('dl[xid="'.concat(t,'"]'));n.find(".xm-select-active").removeClass("xm-select-active");for(var a,c,o=e.value.split("/"),i=0,r=[];a=o[i],(c=n.find(".xm-select-linkage-group".concat(i+1,' li[xm-value="').concat(a,'"]')))[0]&&r.push(c),i++,c.length&&null!=a;);r.length==o.length&&B.each(r,function(t,e){e.addClass("xm-select-this")})},t.prototype.linkageDel=function(t,e){for(var n,a,c=B('dl[xid="'.concat(t,'"]')),o=e.value.split("/"),i=o.length-1;n=o[i],(a=c.find(".xm-select-linkage-group".concat(i+1,' li[xm-value="').concat(n,'"]'))).parent().next().find("li[pid=".concat(n,"].xm-select-this")).length||a.removeClass("xm-select-this"),i--,a.length&&null!=n;);},t.prototype.valToName=function(t,e){var a=B('dl[xid="'.concat(t,'"]')),n=(e+"").split("/");if(!n.length)return null;var c=[];return B.each(n,function(t,e){var n=a.find(".xm-select-linkage-group".concat(t+1,' li[xm-value="').concat(e,'"] span')).text();c.push(n)}),c.length==n.length?c.join("/"):null},t.prototype.commonHandler=function(t,e){e&&e[0]&&(this.checkHideSpan(t,e),this.changePlaceHolder(e),this.retop(e.parents(".".concat(F))),this.calcLabelLeft(e,0,!0),this.setHidnVal(t,e),e.parents(".".concat(H," .").concat(v)).attr("title",W[t].values.map(function(t){return t.name}).join(",")))},t.prototype.initVal=function(t){var r=this,e={};t?e[t]=W[t]:e=W,B.each(e,function(n,t){var e=t.values,a=B('dl[xid="'.concat(n,'"]')).parent(),c=a.find(".".concat(k)),o=a.find("dl");o.find("dd.".concat(C)).removeClass(C);var i=e.concat([]);i.concat([]).forEach(function(t,e){r.addLabel(n,c,t),o.find('dd[lay-value="'.concat(t.value,'"]')).addClass(C)}),t.config.radio&&i.length&&e.push(i[i.length-1]),r.commonHandler(n,c)})},t.prototype.setHidnVal=function(t,e){e&&e[0]&&e.parents(".".concat(y)).find(".".concat(N)).val(W[t].values.map(function(t){return t.value}).join(","))},t.prototype.handlerLabel=function(t,e,n,a,c){var o=B('[xid="'.concat(t,'"]')).prev().find(".".concat(k)),i=e&&this.getItem(t,e),r=W[t].values,l=W[t].config.on||J.on[t],s=W[t].config.endOn||J.endOn[t];a&&(i=a);var d,f,u=W[t];n&&u.config.max&&u.values.length>=u.config.max?(d=J.maxTips[t]||W[t].config.maxTips)&&d(t,r.concat([]),i,u.config.max):!c&&l&&l instanceof Function&&0==l(t,r.concat([]),i,n,e&&e.hasClass(T))||(f=B('dl[xid="'.concat(t,'"]')),n?(e&&e[0]?(e.addClass(C),e.removeClass(p)):f.find(".xm-select-linkage")[0]&&this.linkageAdd(t,i),this.addLabel(t,o,i),r.push(i)):(e&&e[0]?e.removeClass(C):f.find(".xm-select-linkage")[0]&&this.linkageDel(t,i),this.delLabel(t,o,i),this.remove(r,i)),o[0]&&(u.config.radio&&this.changeShow(o,!1),o.parents(".".concat(H)).prev().removeClass("layui-form-danger"),u.config.clearInput&&this.clearInput(t),this.commonHandler(t,o),!c&&s&&s instanceof Function&&s(t,r.concat([]),i,n,e&&e.hasClass(T))))},t.prototype.addLabel=function(t,e,n){var a,c,o,i,r;n&&(a='fsw="'.concat(v,'"'),i=(c=[B("<span ".concat(a,' value="').concat(n.value,'"><font ').concat(a,">").concat(n.name,"</font></span>")),B("<i ".concat(a,' class="xm-iconfont icon-close"></i>'))])[1],(o=c[0]).append(i),(r=W[t]).config.radio&&(r.values.length=0,B('dl[xid="'.concat(t,'"]')).find("dd.".concat(C,':not([lay-value="').concat(n.value,'"])')).removeClass(C),e.find("span").remove()),e.find("input").css("width","50px"),e.find("input").before(o))},t.prototype.delLabel=function(t,e,n){n&&e.find('span[value="'.concat(n.value,'"]:first')).remove()},t.prototype.checkHideSpan=function(t,e){e.parents(".".concat(v))[0].offsetHeight;e.find("span.xm-span-hide").removeClass("xm-span-hide"),e.find("span[style]").remove();var n=W[t].config.showCount;e.find("span").each(function(t,e){n<=t&&B(e).addClass("xm-span-hide")});var a=e.find("span:eq(".concat(n,")"));a[0]&&a.before(B('<span style="padding-right: 6px;" fsw="'.concat(v,'"> + ').concat(e.find("span").length-n,"</span>")))},t.prototype.retop=function(t){var e=t.find("dl"),n=t.offset().top+t.outerHeight()+5-l.scrollTop(),a=e.outerHeight(),c=t.hasClass("layui-form-selectup")||-1!=e.css("top").indexOf("-")||n+a>l.height()&&a<=n;t=t.find(".".concat(v));var o=W[e.attr("xid")],i=e.parents(".layui-form-pane")[0]&&38<e.prev()[0].clientHeight?14:10;(o&&"up"==o.config.direction||c)&&(c=!0,o&&"down"==o.config.direction&&(c=!1));var r=t[0].offsetTop+t.height()+i;c?e.css({top:"auto",bottom:r+3+"px"}):e.css({top:r+"px",bottom:"auto"})},t.prototype.changeShow=function(t,e){B(".layui-form-selected").removeClass("layui-form-selected");var n,a,c=t.parents(".".concat(F)),o=c.hasClass(d),i=c.find("dl").attr("xid");B(".".concat(y," .").concat(F)).not(c).removeClass(d),e?(this.retop(c),c.addClass(d),c.find(".".concat(g)).focus(),c.find("dl dd[lay-value]:not(.".concat(V,")")).length||c.find("dl .".concat(_)).addClass(O)):(c.removeClass(d),this.clearInput(i),c.find("dl .".concat(O)).removeClass(O),c.find("dl dd.".concat(h)).removeClass(h),c.find("dl dd.".concat(p)).remove(),i&&W[i]&&W[i].config.isEmpty&&this.triggerSearch(c),this.changePlaceHolder(c.find(".".concat(k)))),e!=o&&(n=W[i].config.opened||J.opened[i],e&&n&&n instanceof Function&&n(i),a=W[i].config.closed||J.closed[i],!e&&a&&a instanceof Function&&a(i))},t.prototype.changePlaceHolder=function(t){var e,n,a,c,o,i,r=t.parents(".".concat(H));r[0]||(r=t.parents("dl").prev()),r[0]&&(e=t.parents(".".concat(y)).find("dl[xid]").attr("xid"),W[e]&&W[e].config.height||(n=r.find(".".concat(v))[0].clientHeight,r.css("height",(36<n?n+4:n)+"px"),(a=r.parents(".".concat(y)).parent().prev()).is(".layui-form-label")&&r.parents(".layui-form-pane")[0]&&(n=36<n?n+4:n,r.css("height",n+"px"),a.css({height:n+2+"px",lineHeight:n-18+"px"}))),c=r.find(".".concat(x," input")),!t.find("span:last")[0]&&!r.find(".".concat(g)).val()?(o=c.attr("back"),c.removeAttr("back"),c.attr("placeholder",o)):(i=c.attr("placeholder"),c.removeAttr("placeholder"),c.attr("back",i)))},t.prototype.indexOf=function(t,e){for(var n=0;n<t.length;n++)if(t[n].value==e||t[n].value==(e?e.value:e)||t[n]==e||JSON.stringify(t[n])==JSON.stringify(e))return n;return-1},t.prototype.remove=function(t,e){var n=this.indexOf(t,e?e.value:e);return-1<n&&(t.splice(n,1),!0)},t.prototype.selectAll=function(a,c,t){var o=this,i=B('[xid="'.concat(a,'"]'));i[0]&&(i.find(".xm-select-linkage")[0]||i.find("dd[lay-value]:not(.".concat(V,"):not(.").concat(C,")").concat(t?":not(."+T+")":"")).each(function(t,e){e=B(e);var n=o.getItem(a,e);o.handlerLabel(a,i.find('dd[lay-value="'.concat(n.value,'"]')),!0,n,!c)}))},t.prototype.removeAll=function(n,a,c){var o=this,i=B('[xid="'.concat(n,'"]'));i[0]&&(i.find(".xm-select-linkage")[0]?W[n].values.concat([]).forEach(function(t,e){for(var n,a,c=t.value.split("/"),o=0;n=c[o++],(a=i.find(".xm-select-linkage-group".concat(o,':not(.xm-select-linkage-hide) li[xm-value="').concat(n,'"]'))).click(),a.length&&null!=n;);}):W[n].values.concat([]).forEach(function(t,e){c&&i.find('dd[lay-value="'.concat(t.value,'"]')).hasClass(T)||o.handlerLabel(n,i.find('dd[lay-value="'.concat(t.value,'"]')),!1,t,!a)}))},t.prototype.reverse=function(a,c,t){var o=this,i=B('[xid="'.concat(a,'"]'));i[0]&&(i.find(".xm-select-linkage")[0]||i.find("dd[lay-value]:not(.".concat(V,")").concat(t?":not(."+T+")":"")).each(function(t,e){e=B(e);var n=o.getItem(a,e);o.handlerLabel(a,i.find('dd[lay-value="'.concat(n.value,'"]')),!e.hasClass(C),n,!c)}))},t.prototype.skin=function(t){var e=["default","primary","normal","warm","danger"],n=e[Math.floor(Math.random()*e.length)];B('dl[xid="'.concat(t,'"]')).parents(".".concat(y)).find(".".concat(F)).attr("xm-select-skin",n),this.check(t)&&this.commonHandler(t,B('dl[xid="'.concat(t,'"]')).parents(".".concat(y)).find(".".concat(k)))},t.prototype.getPosition=function(t){for(var e=0,n=0;null!=t;)e+=t.offsetLeft,n+=t.offsetTop,t=t.offsetParent;return{x:e,y:n}},t.prototype.onreset=function(){B(document).on("click","[type=reset]",function(t){B(t.target).parents("form").find(".".concat(y," dl[xid]")).each(function(t,e){var n,a=e.getAttribute("xid"),c=B(e),o={};X.removeAll(a),W[a].config.init.forEach(function(t,e){t&&(!o[t]||W[a].config.repeat)&&(n=c.find('dd[lay-value="'.concat(t.value,'"]')))[0]&&(X.handlerLabel(a,n,!0),o[t]=1)})})})},t.prototype.bindEvent=function(n,t,a){t&&t instanceof Function&&(a=t,t=null),a&&a instanceof Function&&(t?W[t]?(W[t].config[n]=a,delete J[n][t]):J[n][t]=a:B.each(W,function(t,e){W[t]?W[t].config[n]=a:J[n][t]=a}))},t.prototype.check=function(t,e){return!!B('dl[xid="'.concat(t,'"]')).length||(B('select[xm-select="'.concat(t,'"]')).length?e?void 0:(this.render(t,B('select[xm-select="'.concat(t,'"]'))),!0):(delete W[t],!1))},t.prototype.render=function(t,e){X.init(e),X.one(B('dl[xid="'.concat(t,'"]')).parents(".".concat(y))),X.initVal(t)},t.prototype.log=function(t){};function e(){this.v="4.0.0.0910",this.render()}var X=new t;return e.prototype.value=function(n,t,e){if("string"!=typeof n)return[];var a,c,o,i,r=W[n];if(!X.check(n))return[];if("string"==typeof t||null==t){var l=r.values.concat([])||[];return"val"==t?l.map(function(t){return t.value}):"valStr"==t?l.map(function(t){return t.value}).join(","):"name"==t?l.map(function(t){return t.name}):"nameStr"==t?l.map(function(t){return t.name}).join(","):l}X.isArray(t)&&(a=B('[xid="'.concat(n,'"]')),c={},i=!0,0==e?i=!1:1==e?i=!0:X.removeAll(n),i&&r.values.forEach(function(t,e){c[t.value]=1}),t.forEach(function(t,e){!t||c[t]&&!r.config.repeat||((o=a.find('dd[lay-value="'.concat(t,'"]')))[0]?(X.handlerLabel(n,o,i,null,!0),c[t]=1):X.valToName(n,t)&&(X.handlerLabel(n,o,i,X.getItem(n,t),!0),c[t]=1))}))},e.prototype.on=function(t,e,n){return X.bindEvent(n?"endOn":"on",t,e),this},e.prototype.filter=function(t,e){return X.bindEvent("filter",t,e),this},e.prototype.maxTips=function(t,e){return X.bindEvent("maxTips",t,e),this},e.prototype.opened=function(t,e){return X.bindEvent("opened",t,e),this},e.prototype.closed=function(t,e){return X.bindEvent("closed",t,e),this},e.prototype.config=function(t,n,e){return t&&"object"==_typeof(t)&&(e=1==n,n=t,t=null),n&&"object"==_typeof(n)&&(e&&(n.header||(n.header={}),n.header["Content-Type"]="application/json; charset=UTF-8",n.dataType="json"),t?(q[t]=B.extend(!0,{},q[t]||R,n),X.check(t)||this.render(t),W[t]&&n.direction&&(W[t].config.direction=n.direction),W[t]&&n.clearInput&&(W[t].config.clearInput=!0),n.searchUrl&&W[t]&&X.triggerSearch(B(".".concat(y,' dl[xid="').concat(t,'"]')).parents(".".concat(F)),!0)):(B.extend(!0,R,n),B.each(q,function(t,e){B.extend(!0,e,n)}))),this},e.prototype.render=function(t,e){var n;t&&"object"==_typeof(t)&&(e=t,t=null);var a=e?(_defineProperty(n={init:e.init,disabled:e.disabled,max:e.max,isSearch:e.isSearch,searchUrl:e.searchUrl,isCreate:e.isCreate,radio:e.radio,skin:e.skin,direction:e.direction,height:e.height,formname:e.formname,layverify:e.layverify,layverType:e.layverType,showCount:e.showCount,placeholder:e.placeholder,create:e.create,filter:e.filter,maxTips:e.maxTips,on:e.on},"on",e.on),_defineProperty(n,"opened",e.opened),_defineProperty(n,"closed",e.closed),_defineProperty(n,"template",e.template),_defineProperty(n,"clearInput",e.clearInput),n):{};return e&&null!=e.searchType&&(a.searchType="dl"==e.searchType?1:0),t?(o[t]={},B.extend(o[t],W[t]?W[t].config:{},a)):B.extend(c,a),(B("select[".concat(v,'="').concat(t,'"]'))[0]?B("select[".concat(v,'="').concat(t,'"]')):B("select[".concat(v,"]"))).each(function(t,e){var n=e.getAttribute(v);X.render(n,e),setTimeout(function(){return X.setHidnVal(n,B('select[xm-select="'.concat(n,'"] + div.').concat(y," .").concat(k)))},10)}),this},e.prototype.disabled=function(t){var e={};return t?X.check(t)&&(e[t]=W[t]):e=W,B.each(e,function(t,e){B('dl[xid="'.concat(t,'"]')).prev().addClass(L)}),this},e.prototype.undisabled=function(t){var e={};return t?X.check(t)&&(e[t]=W[t]):e=W,B.each(e,function(t,e){B('dl[xid="'.concat(t,'"]')).prev().removeClass(L)}),this},e.prototype.data=function(t,e,n){return t&&e&&n?X.check(t)?(this.value(t,[]),this.config(t,n),"local"==e?X.renderData(t,n.arr,1==n.linkage,n.linkageWidth?n.linkageWidth:"100"):"server"==e&&X.ajax(t,n.url,n.keyword,1==n.linkage,n.linkageWidth?n.linkageWidth:"100")):X.log("id: ".concat(t," not render !!!")):X.log("id: ".concat(t," param error !!!")),this},e.prototype.btns=function(t,r,l){if(t&&X.isArray(t)&&(r=t,t=null),!r||!X.isArray(r))return this;var e={};return t?X.check(t)&&(e[t]=W[t]):e=W,r=r.map(function(t){if("string"==typeof t){if("select"==t)return a[0];if("remove"==t)return a[1];if("reverse"==t)return a[2];if("skin"==t)return a[3]}return t}),B.each(e,function(t,e){e.config.btns=r;var n,a,c,o,i=B('dl[xid="'.concat(t,'"]')).find(".".concat(V,":first"));r.length?(n=l&&l.show&&("name"==l.show||"Core.Resources.assets.layui.layer.icon"==l.show)?l.show:"",a=X.renderBtns(t,n,l&&l.space?l.space:"30px"),i.html(a)):(o=(c=i.parents(".".concat(F)).find(".".concat(x," input"))).attr("placeholder")||c.attr("back"),i.html(o),i.removeAttr("style"))}),this},e.prototype.search=function(t,e){return t&&X.check(t)&&(q[t]=B.extend(!0,{},q[t]||R,{first:!0,searchVal:e}),X.triggerSearch(B('dl[xid="'.concat(t,'"]')).parents(".".concat(F)),!0)),this},e.prototype.replace=function(t,e,n){var a=this;if(!t||!e||!n)return X.log("id: ".concat(t," param error !!!")),this;if(!X.check(t,!0))return X.log("id: ".concat(t," not render !!!")),this;var c=this.value(t,"val");this.value(t,[]),this.config(t,n),"local"==e?(X.renderData(t,n.arr,1==n.linkage,n.linkageWidth?n.linkageWidth:"100",!1,!0),this.value(t,c,!0)):"server"==e&&X.ajax(t,n.url,n.keyword,1==n.linkage,n.linkageWidth?n.linkageWidth:"100",!1,function(t){a.value(t,c,!0)},!0)},new e});